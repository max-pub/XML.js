window.XML={parse:(e,r="text/xml")=>(new DOMParser).parseFromString(e,r),stringify:e=>(new XMLSerializer).serializeToString(e),fetch:async e=>XML.parse(await fetch(e).then(e=>e.text())),transform:(e,r,t=!0)=>{let s=new XSLTProcessor;s.importStylesheet("string"==typeof r?XML.parse(r):r);let n=s.transformToFragment("string"==typeof e?XML.parse(e):e,document);return t?XML.stringify(n):n}};window.XML={...window.XML,minify:t=>XML.toString(t),prettify:t=>XML.toString(t,{prettify:!0}),highlight:t=>XML.toString(t,{prettify:!0,highlight:!0}),toString:(t,e,i=0)=>{e={prettify:!1,highlight:!1,inlineTags:["b","i","u","q"],...e},"string"==typeof t&&(t=XML.parse(t));let r=e.prettify?Array(i+1).fill("").join("\t"):"",n=e.prettify?"\n":"",l=e.highlight?"&lt;":"<",o=e.highlight?"&gt;":">",g=(t,i,r="")=>e.highlight?`<${t} ${r?`class='${r}'`:""}>${i}</${t}>`:i,a=t=>{if(["null","undefined","NaN","true","false"].includes(t))return t;if(1*t==t)return"number";let e=new Date(t);return e.getFullYear()>1900&&e.getFullYear()<2100?"date":e.getFullYear()>1e3&&e.getFullYear()<5e3?"far-date":""};if(3==t.nodeType&&!t.textContent.trim())return"";if(3==t.nodeType)return r+g("content",t.textContent.trim())+n;if(!t.tagName)return XML.toString(t.firstChild,e);let h=r+g("control",l)+g("tag",t.tagName),d=1==t.childNodes.length&&3==t.childNodes[0].nodeType&&!t.childNodes[0].textContent.trim().includes("\n"),u=d&&""==t.childNodes[0].textContent.trim();for(let e=0;e<t.attributes.length;e++)h+=" "+g("attribute",t.attributes[e].name,t.attributes[e].name)+g("control",'="')+g("value",t.attributes[e].value,a(t.attributes[e].value))+g("control",'"');if(0==t.childNodes.length||u)return h+g("control"," /"+o)+n;h+=g("control",o),d||(h+=n);for(let r=0;r<t.childNodes.length;r++)h+=d?g("content",t.childNodes[r].textContent.trim(),a(t.childNodes[r].textContent.trim())):XML.toString(t.childNodes[r],e,i+1);return h+(d?"":r)+g("control",l)+g("tag",t.tagName)+g("control",o)+n}};