import base from"./base.js";export default class XML extends base{static minify(t){return XML.toString(t)}static prettify(t){return XML.toString(t,{prettify:!0})}static highlight(t){return XML.toString(t,{prettify:!0,highlight:!0})}static escape(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/([^\x09\x0A\x0D\x20-\uD7FF\uE000-\uFFFC\u{10000}-\u{10FFFF}])/gu,"").replace(/([\x7F-\x84]|[\x86-\x9F]|[\uFDD0-\uFDEF]|[\u{1FFFE}-\u{1FFFF}]|[\u{2FFFE}-\u{2FFFF}]|[\u{3FFFE}-\u{3FFFF}]|[\u{4FFFE}-\u{4FFFF}]|[\u{5FFFE}-\u{5FFFF}]|[\u{6FFFE}-\u{6FFFF}]|[\u{7FFFE}-\u{7FFFF}]|[\u{8FFFE}-\u{8FFFF}]|[\u{9FFFE}-\u{9FFFF}]|[\u{AFFFE}-\u{AFFFF}]|[\u{BFFFE}-\u{BFFFF}]|[\u{CFFFE}-\u{CFFFF}]|[\u{DFFFE}-\u{DFFFF}]|[\u{EFFFE}-\u{EFFFF}]|[\u{FFFFE}-\u{FFFFF}]|[\u{10FFFE}-\u{10FFFF}].)/gu,"")}static toString(t,e,F=0){e={prettify:!1,highlight:!1,escapeValues:!0,skipEmptyAttributes:!0,skipEmptyNodes:!0,inlineTags:["b","i","u","q"],...e},"string"==typeof t&&(t=XML.parse(t));let r=e.prettify?Array(F+1).fill("").join("\t"):"",u=e.prettify?"\n":"",i=e.highlight?"&lt;":"<",l=e.highlight?"&gt;":">",n=(t,F,r="")=>e.highlight?`<${t} ${r?`class='${r}'`:""}>${a(F)}</${t}>`:F,a=t=>e.escapeValues?this.escape(t):t,o=t=>{if(["null","undefined","NaN","true","false"].includes(t))return t;if(1*t==t)return"number";let e=new Date(t);return e.getFullYear()>1900&&e.getFullYear()<2100?"date":e.getFullYear()>1e3&&e.getFullYear()<5e3?"far-date":""};if(3==t.nodeType&&!t.textContent.trim())return"";if(3==t.nodeType)return r+n("content",t.textContent.trim())+u;if(!t.tagName){let r="";for(let u=0;u<t.childNodes.length;u++)r+=XML.toString(t.childNodes[u],e,F);return r}if(e.skipEmptyNodes&&0==t.attributes.length&&0==t.childNodes.length)return"";let s=r+n("control",i)+n("tag",t.tagName),g=1==t.childNodes.length&&3==t.childNodes[0].nodeType&&!t.childNodes[0].textContent.trim().includes("\n"),c=g&&""==t.childNodes[0].textContent.trim();for(let F=0;F<t.attributes.length;F++)e.skipEmptyAttributes&&!t.attributes[F].value||(s+=" "+n("pair",n("attribute",t.attributes[F].name,t.attributes[F].name)+n("control",'="')+n("value",a(t.attributes[F].value),o(t.attributes[F].value))+n("control",'"')));if(0==t.childNodes.length||c)return s+n("control"," /"+l)+u;s+=n("control",l),g||(s+=u);for(let r=0;r<t.childNodes.length;r++)s+=g?n("content",t.childNodes[r].textContent.trim(),o(t.childNodes[r].textContent.trim())):XML.toString(t.childNodes[r],e,F+1);return s+(g?"":r)+n("control",i+"/")+n("tag",t.tagName)+n("control",l)+u}}