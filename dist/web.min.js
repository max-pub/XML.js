window.XML={parse:(t,e="text/xml")=>(new DOMParser).parseFromString(t,e),stringify:t=>(new XMLSerializer).serializeToString(t),fetch:async t=>XML.parse(await fetch(t).then(t=>t.text())),transform:(t,e)=>{let r=new XSLTProcessor;r.importStylesheet("string"==typeof e?XML.parse(e):e);let i=r.transformToFragment("string"==typeof t?XML.parse(t):t,document);return"string"==typeof t?XML.stringify(i):i},minify:t=>XML.toString(t),prettify:t=>XML.toString(t,{prettify:!0}),highlight:t=>XML.toString(t,{prettify:!0,highlight:!0}),toString:(t,e,r=0)=>{e={prettify:!1,highlight:!1,inlineTags:["b","i","u","q"],...e},"string"==typeof t&&(t=XML.parse(t));let i=e.prettify?Array(r+1).fill("").join("\t"):"",n=e.prettify?"\n":"",o=e.highlight?"&lt;":"<",l=e.highlight?"&gt;":">",a=(t,r,i="")=>e.highlight?`<${t} class='${i}'>${r}</${t}>`:r,g=t=>{if("null"==t)return"null";if("undefined"==t)return"undefined";if("NaN"==t)return"NaN";if(1*t==t)return"number";let e=new Date(t);return e.getFullYear()>1970&&e.getFullYear()<2030?"date":void 0};if(3==t.nodeType&&!t.textContent.trim())return"";if(3==t.nodeType)return i+t.textContent.trim()+n;if(!t.tagName)return XML.toString(t.firstChild,e);let s=i+a("control",o)+a("tag",t.tagName),h=1==t.childNodes.length&&3==t.childNodes[0].nodeType&&!t.childNodes[0].textContent.trim().includes("\n"),f=h&&""==t.childNodes[0].textContent.trim();for(let e=0;e<t.attributes.length;e++)s+=" "+a("attribute",t.attributes[e].name)+a("control",'="')+a("value",t.attributes[e].value,g(t.attributes[e].value))+a("control",'"');if(0==t.childNodes.length||f)return s+a("control"," /"+l)+n;s+=a("control",l),h||(s+=n);for(let i=0;i<t.childNodes.length;i++)s+=h?a("content",t.childNodes[i].textContent.trim(),g(t.childNodes[i].textContent.trim())):XML.toString(t.childNodes[i],e,r+1);return s+(h?"":i)+a("control",o)+a("tag",t.tagName)+a("control",l)+n}};