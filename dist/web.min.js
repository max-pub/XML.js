window.XML={parse:(t,e="text/xml")=>(new DOMParser).parseFromString(t,e),stringify:t=>(new XMLSerializer).serializeToString(t),fetch:async t=>XML.parse(await fetch(t).then(t=>t.text())),transform:(t,e)=>{let r=new XSLTProcessor;r.importStylesheet("string"==typeof e?XML.parse(e):e);let n=r.transformToFragment("string"==typeof t?XML.parse(t):t,document);return"string"==typeof t?XML.stringify(n):n},minify:t=>XML.toString(t),prettify:t=>XML.toString(t,{prettify:!0}),highlight:t=>XML.toString(t,{prettify:!0,highlight:!0}),toString:(t,e,r=0)=>{e={prettify:!1,highlight:!1,inlineTags:["b","i","u","q"],...e},"string"==typeof t&&(t=XML.parse(t));let n=e.prettify?Array(r+1).fill("").join("\t"):"",i=e.prettify?"\n":"",l=e.highlight?"&lt;":"<",o=e.highlight?"&gt;":">",a=(t,r,n="")=>e.highlight?`<${t} ${n?`class='${n}'`:""}>${r}</${t}>`:r,g=t=>{if("null"==t)return"null";if("undefined"==t)return"undefined";if("NaN"==t)return"NaN";if("true"==t)return"boolean true";if("false"==t)return"boolean false";if(1*t==t)return"number";let e=new Date(t);return e.getFullYear()>1900&&e.getFullYear()<2100?"date":e.getFullYear()>1e3&&e.getFullYear()<5e3?"fardate":""};if(3==t.nodeType&&!t.textContent.trim())return"";if(3==t.nodeType)return n+a("content",t.textContent.trim())+i;if(!t.tagName)return XML.toString(t.firstChild,e);let s=n+a("control",l)+a("tag",t.tagName),f=1==t.childNodes.length&&3==t.childNodes[0].nodeType&&!t.childNodes[0].textContent.trim().includes("\n"),h=f&&""==t.childNodes[0].textContent.trim();for(let e=0;e<t.attributes.length;e++)s+=" "+a("attribute",t.attributes[e].name,t.attributes[e].name)+a("control",'="')+a("value",t.attributes[e].value,g(t.attributes[e].value))+a("control",'"');if(0==t.childNodes.length||h)return s+a("control"," /"+o)+i;s+=a("control",o),f||(s+=i);for(let n=0;n<t.childNodes.length;n++)s+=f?a("content",t.childNodes[n].textContent.trim(),g(t.childNodes[n].textContent.trim())):XML.toString(t.childNodes[n],e,r+1);return s+(f?"":n)+a("control",l)+a("tag",t.tagName)+a("control",o)+i}};