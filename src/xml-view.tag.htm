<template>
    <iframe></iframe>
</template>

<script>
    class{
         connectedCallback(){
            new MutationObserver(()=>{
                this.$('iframe').hidden = this.hidden;
            }).observe(this, {attributes: true}); // on hide, hide iframe too
             import('./web.min.js');
        }
        set value(text){
            // console.log('xml-value',text);
            this.show();
            // this.$('iframe').contentWindow.document.body.innerHTML = `<img class='load-indicator' src='https://samherbert.net/svg-loaders/svg-loaders/bars.svg'/>`
            this.theme = {
                dark:`
                    @import url('https://fonts.googleapis.com/css?family=Source+Code+Pro&display=swap');
                    body{tab-size: 4; -moz-tab-size: 4; font-size: 14px; white-space: pre;  font-family: 'Source Code Pro', monospace;}
                    tag,attribute,control{font-weight: bold;}

                    body{background: #333; color: white;}
                    tag{color: cornflowerblue;  }
                    attribute{color: skyblue; }
                    .date{color: lime;}
                    .number{color: orange;}
                    .undefined,.null,.NaN{color: violet;}
                    value{color: white;}
                    control{color: silver; }                
                `,
                lite:`
                    @import url('https://fonts.googleapis.com/css?family=Source+Code+Pro&display=swap');
                    body{ tab-size: 4; -moz-tab-size: 4; font-size: 14px; white-space: pre;  font-family: 'Source Code Pro', monospace;}
                    tag,attribute,control{font-weight: bold;}

                    body{background: white; color: black;}
                    tag{color: cornflowerblue;  }
                    attribute{color: skyblue; }
                    .date{color: lime;}
                    .number{color: orange;}
                    .undefined,.null,.NaN{color: violet;}
                    value{color: black;}
                    control{color: silver; }                
                `
            }
            this.$('iframe').contentWindow.document.body.innerHTML = `<style>${this.theme[this.getAttribute('theme') || 'dark']}</style>` + XML.highlight(text);

        }
        hide(){this.hidden = true; this.$('iframe').hidden = true;}
        show(){this.hidden = false; this.$('iframe').hidden = false;}
    }
</script>

<style>
    :host{display: block;}
    iframe{width: 100%; height: 100%; border: none;}
</style>